(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2085e525"],{5426:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("a-page-header",{staticStyle:{padding:"5px 5px 0 5px"},attrs:{title:e.usageModeHelper.title,"sub-title":e.usageModeHelper.subTitle},on:{back:function(){return e.$router.go(-1)}}},[a("template",{slot:"tags"},[a("a-tag",{directives:[{name:"show",rawName:"v-show",value:e.data.lastStatusDesc,expression:"data.lastStatusDesc"}],style:{color:[3,4,-1].includes(e.data.lastStatus)?"red":"green"}},[e._v(e._s(e.data.lastStatusDesc))])],1),a("template",{slot:"extra"},[a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.usageModeHelper.showStartButton,expression:"usageModeHelper.showStartButton"}],staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small",disabled:!e.data.authMap.start},on:{click:e.onStart}},[e._v("启动")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.usageModeHelper.showStopButton,expression:"usageModeHelper.showStopButton"}],staticStyle:{"margin-right":"5px"},attrs:{type:"danger",size:"small",disabled:!e.data.authMap.stop},on:{click:e.onStop}},[e._v("停止")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.usageModeHelper.showEditButton,expression:"usageModeHelper.showEditButton"}],staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small",disabled:!e.data.authMap.edit},on:{click:e.onEdit}},[e._v("编辑")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.usageModeHelper.showDetailButton,expression:"usageModeHelper.showDetailButton"}],staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:e.onDetail}},[e._v("详情")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.usageModeHelper.showDeleteButton,expression:"usageModeHelper.showDeleteButton"}],staticStyle:{"margin-right":"5px"},attrs:{type:"danger",size:"small",disabled:!e.data.authMap.delete},on:{click:e.onDelete}},[e._v("删除")]),a("a-button",{attrs:{type:"primary",size:"small"},on:{click:e.onGoBack}},[e._v("返回")])],1)],2)],1),a("a-tabs",{attrs:{"default-active-key":"1"},on:{change:e.handleTabChange}},[a("a-tab-pane",{key:"job"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"file-text"}}),e._v(" 作业信息 ")],1),a("a-spin",{attrs:{spinning:e.usageModeHelper.isLoading,size:"large"}},[a("div",{staticStyle:{"margin-top":"20px"}},[a("h2",[e._v("基本配置")]),a("a-form-model",{ref:"ruleForm",attrs:{model:e.data,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{attrs:{label:"作业名称",prop:"name"}},[a("a-input",{model:{value:e.data.name,callback:function(t){e.$set(e.data,"name",t)},expression:"data.name"}})],1),a("a-form-model-item",{attrs:{label:"作业类型",prop:"type"}},[a("a-select",{attrs:{placeholder:"请选择作业类型",disabled:""},model:{value:e.data.type,callback:function(t){e.$set(e.data,"type",t)},expression:"data.type"}},e._l(e.helper.jobTypeList,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t.value}},[e._v(" "+e._s(t.desc)+" ")])})),1)],1),a("a-form-model-item",{attrs:{label:"作业描述"}},[a("a-textarea",{model:{value:e.data.description,callback:function(t){e.$set(e.data,"description",t)},expression:"data.description"}})],1),a("H2",[e._v("作业配置")]),a("a-form-model-item",{attrs:{label:"客户端版本",prop:"clientVersion"}},[a("a-select",{attrs:{placeholder:"请选择版本"},model:{value:e.data.clientVersion,callback:function(t){e.$set(e.data,"clientVersion",t)},expression:"data.clientVersion"}},e._l(e.helper.jobClientVersionList,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t.value}},[e._v(" "+e._s(t.desc)+" ")])})),1)],1),a("a-form-model-item",{attrs:{label:"执行文件",prop:"configJarName"}},[a("a-select",{attrs:{placeholder:"请选择文件"},model:{value:e.data.flinkConfig.jarName,callback:function(t){e.$set(e.data.flinkConfig,"jarName",t)},expression:"data.flinkConfig.jarName"}},e._l(e.helper.jobJarList,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1),a("a-upload",{attrs:{name:"file",action:e.jobUploadJarUrl},on:{change:e.handleJarUploadChange}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传文件 ")],1)],1)],1),a("a-form-model-item",{attrs:{label:"MainClass",prop:"configMainClass"}},[a("a-input",{model:{value:e.data.flinkConfig.mainClass,callback:function(t){e.$set(e.data.flinkConfig,"mainClass",t)},expression:"data.flinkConfig.mainClass"}})],1),a("a-form-model-item",{attrs:{label:"程序参数",prop:"configArgs"}},[a("a-textarea",{model:{value:e.data.flinkConfig.args,callback:function(t){e.$set(e.data.flinkConfig,"args",t)},expression:"data.flinkConfig.args"}})],1),a("H2",[e._v("运行参数")]),a("a-form-model-item",{attrs:{label:"作业并行度",prop:"configParallelism"}},[a("a-input-number",{attrs:{min:1},model:{value:e.data.flinkConfig.parallelism,callback:function(t){e.$set(e.data.flinkConfig,"parallelism",t)},expression:"data.flinkConfig.parallelism"}})],1),a("a-form-model-item",{attrs:{"wrapper-col":{span:e.wrapperCol.span,offset:e.labelCol.span}}},[a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.usageModeHelper.showAddButton,expression:"usageModeHelper.showAddButton"}],attrs:{type:"primary"},on:{click:e.onAdd}},[e._v(" 新建 ")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.usageModeHelper.showUpdateButton,expression:"usageModeHelper.showUpdateButton"}],attrs:{type:"primary"},on:{click:e.onUpdate}},[e._v(" 更新 ")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:e.usageModeHelper.showRest,expression:"usageModeHelper.showRest"}],staticStyle:{"margin-left":"10px"},on:{click:e.onRest}},[e._v(" 清空 ")])],1)],1)],1)])],1),a("a-tab-pane",{key:"instList"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"database"}}),e._v(" 实例列表 ")],1),a("InstList",{ref:"refInstList",attrs:{"job-id":e.dataId,"is-auto-flush":!0}})],1)],1)],1)},o=[],i=(a("a4d3"),a("e01a"),a("caad"),a("b0c0"),a("ac1f"),a("5319"),a("76fe")),n=a("782f"),l=a("bf3b"),r={name:"JobCustomAddEditDetail",components:{InstList:l["default"]},props:{usageMode:{default:""},dataId:{default:-1}},computed:{jobUploadJarUrl:function(){return i["UPLOAD_JAR_URL"].replace("{jobId}",this.dataId)}},watch:{data:{deep:!0,handler:function(){"edit"!==this.usageMode&&"detail"!==this.usageMode||(this.usageModeHelper.title=this.data.name,this.usageModeHelper.subTitle=this.data.description)}}},data:function(){return{labelCol:{span:4},wrapperCol:{span:16},data:{id:null,name:"",type:1,lastStatus:null,statusDesc:"",clientVersion:"",flinkConfig:{jarName:"",mainClass:"",args:"",parallelism:1},authMap:{edit:!1,delete:!1,start:!1,stop:!1,restart:!1}},rules:{name:[{required:!0,message:"请输入作业名！",trigger:"blur"}]},usageModeHelper:{showPassword:!1,showAddButton:!1,showStartButton:!1,showStopButton:!1,showUpdateButton:!1,showEditButton:!1,showDetailButton:!1,showDeleteButton:!1,showRest:!0,isLoading:!1,title:"",subTitle:""},helper:{jobTypeList:[],jobJarList:[],jobClientVersionList:[]},dataTimer:null}},methods:{onAdd:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return e.$message.error("请检查必填项！！！"),!1;i["addJob"](e.data).then((function(t){e.$router.push({path:"/job/jobDetail",query:{jobId:t.data.id}}),e.$Notice.success({title:"新建作业成功！"})}))}))},onUpdate:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return e.$message.error("请检查必填项"),!1;i["updateJob"](e.data).then((function(){e.$router.push({path:"/job/jobDetail",query:{jobId:e.data.id}}),e.$Notice.success({title:"更新作业成功！"})}))}))},onEdit:function(){this.$router.push({path:"/job/jobEdit",query:{jobId:this.data.id}})},onDetail:function(){this.$router.push({path:"/job/jobDetail",query:{jobId:this.data.id}})},onDelete:function(){var e=this;i["deleteJob"](this.data.id).then((function(){e.$Notice.success({title:"删除作业成功！"}),e.$router.push({path:"/job/jobList"})}))},onStart:function(){var e=this;i["startJob"](this.data.id).then((function(){e.$Notice.success({title:"启动作业成功！"}),e.handleFlush(!0)}))},onStop:function(){var e=this;i["stopJob"](this.data.id).then((function(){e.$Notice.success({title:"停止作业成功！"}),e.getData()}))},handleFlush:function(e){e?this.dataTimer||(this.dataTimer=this.getDataTimer()):this.clearDataTimer()},getDataTimer:function(){var e=this;return setInterval((function(){e.getData()}),1e3)},clearDataTimer:function(){clearInterval(this.dataTimer),this.dataTimer=null},onRest:function(){this.data={}},handleJarUploadChange:function(e){"done"===e.file.status?(this.$message.success("".concat(e.file.name," 上传成功！")),this.getJobUploadJarList()):"error"===e.file.status&&this.$message.error("".concat(e.file.name," 上传失败！"))},onGoBack:function(){this.$router.go(-1)},handleTabChange:function(e){"instList"!==e&&this.$refs.refInstList&&this.$refs.refInstList.clearDataListTimer()},initAddUsageModel:function(){this.usageModeHelper.showAddButton=!0,this.usageModeHelper.showUpdateButton=!1,this.usageModeHelper.showPassword=!0,this.usageModeHelper.title="新建作业",this.usageModeHelper.subTitle="请仔细核对作业信息哟！"},initEditUsageModel:function(){this.usageModeHelper.isLoading=!0,this.usageModeHelper.showAddButton=!1,this.usageModeHelper.showUpdateButton=!0,this.usageModeHelper.showPassword=!0,this.usageModeHelper.showPassword=!0,this.usageModeHelper.showDetailButton=!0,this.usageModeHelper.showStartButton=!1,this.usageModeHelper.showStopButton=!1,this.usageModeHelper.title="编辑作业",this.usageModeHelper.subTitle="请仔细核对作业信息哟！"},initDetailUsageModel:function(){this.usageModeHelper.showAddButton=!1,this.usageModeHelper.showUpdateButton=!1,this.usageModeHelper.showPassword=!1,this.usageModeHelper.showRest=!1,this.usageModeHelper.showEditButton=!0,this.usageModeHelper.showDeleteButton=!0,this.usageModeHelper.showStartButton=!0,this.usageModeHelper.showStopButton=!0,this.usageModeHelper.title="作业详情",this.usageModeHelper.subTitle="请仔细核对作业信息哟！"},getData:function(){var e=this;this.usageModeHelper.isLoading=!0,i["getJob"](this.dataId).then((function(t){e.usageModeHelper.isLoading=!1,e.data=t.data,[3,4,5,6].includes(e.data.lastStatus)&&e.clearDataTimer()}))},getJobUploadJarList:function(){var e=this;i["getJobJarList"](this.dataId).then((function(t){e.helper.jobJarList=t.data}))},initHelper:function(){var e=this;n["getJobTypeList"]().then((function(t){e.helper.jobTypeList=t.data})),n["getJobClientVersionList"]().then((function(t){e.helper.jobClientVersionList=t.data})),this.getJobUploadJarList()},initUsageModel:function(){switch(this.usageMode){case"add":this.initAddUsageModel();break;case"edit":this.getData(),this.initEditUsageModel();break;case"detail":this.getData(),this.initDetailUsageModel();break}},beforeDestroy:function(){this.clearDataTimer()},init:function(){this.initHelper(),this.initUsageModel()}},created:function(){this.init()}},d=r,u=a("2877"),p=Object(u["a"])(d,s,o,!1,null,"978a4a1a",null);t["default"]=p.exports},b00a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[1===e.type?[a("JobCustomAddEditDetail",{attrs:{"usage-mode":"detail","data-id":e.jobId}})]:3===e.type?[a("JobSqlAddEditDetail",{attrs:{"usage-mode":"detail","data-id":e.jobId}})]:[e._v(" 等待实现中 。。。 ")]],2)},o=[],i=(a("a9e3"),a("5426")),n=a("fe70"),l={components:{JobCustomAddEditDetail:i["default"],JobSqlAddEditDetail:n["default"]},name:"JobDetail",data:function(){return{jobId:-1,type:-1}},methods:{parseRoute:function(){this.jobId=this.$route.query.jobId,this.type=Number(this.$route.query.type)}},created:function(){this.parseRoute()}},r=l,d=a("2877"),u=Object(d["a"])(r,s,o,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2085e525.37c853d9.js.map