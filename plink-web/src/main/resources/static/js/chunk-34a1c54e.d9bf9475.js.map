{"version":3,"sources":["webpack:///./src/api/helper.js","webpack:///./src/api/inst.js","webpack:///./src/views/inst/list/index.vue?0555","webpack:///src/views/inst/list/index.vue","webpack:///./src/views/inst/list/index.vue?18f6","webpack:///./src/views/inst/list/index.vue?7fce","webpack:///./src/views/inst/list/index.vue?6d0f"],"names":["getInstStatusList","request","url","method","getJobTypeList","getJobClientVersionList","getDefaultFlinkConfs","getInstPageList","filter","params","getInstLog","id","render","_vm","this","_h","$createElement","_c","_self","staticStyle","attrs","staticClass","_v","model","value","dataFilter","callback","$$v","$set","expression","on","getDataList","_l","helper","item","index","key","_s","desc","handleDataListFlush","onQuery","onGoBack","dataColumnList","dataList","isLoading","x","scopedSlots","_u","fn","current","row","job","name","typeDesc","uiAddress","style","color","includes","status","$event","onLog","path","query","instId","page","total","range","onPageNumChange","onPageSizeChange","clientWidth","handleInstLogModalOk","handleInstLogModalCancel","instLog","staticRenderFns","components","SqlCMEditor","props","jobId","default","isAutoFlush","data","pageNum","pageSize","dataTableSelectedRowKeys","isVisible","timer","dataListTimer","jobTypeList","instStatusList","document","documentElement","methods","onEdit","$router","go","onDataTableSelectedChange","selectedRowKeys","inst","lastInst","clearInstLogTimer","checked","getDataListTimer","clearDataListTimer","setInterval","clearInterval","handleInstLogFlush","getInstLogTimer","initHelper","beforeDestroy","created","component"],"mappings":"oJAAA,qOAGO,SAASA,IACd,OAAOC,qBAAQ,CACbC,IAAK,8BACLC,OAAQ,QAIL,SAASC,IACd,OAAOH,qBAAQ,CACbC,IAAK,oBACLC,OAAQ,QAIL,SAASE,IACd,OAAOJ,qBAAQ,CACbC,IAAK,6BACLC,OAAQ,QAIL,SAASG,IACd,OAAOL,qBAAQ,CACbC,IAAK,8BACLC,OAAQ,U,kCC3BZ,kHAGO,SAASI,EAAgBC,GAC9B,OAAOP,qBAAQ,CACbC,IAAK,qCACLC,OAAQ,MACRM,OAAQD,IAIL,SAASE,EAAWC,GACzB,OAAOV,qBAAQ,CACbC,IAAK,6BAA+BS,EACpCR,OAAQ,U,gECdZ,IAAIS,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,CAAC,gBAAgB,OAAO,QAAU,MAAM,mBAAmB,8EAA8E,CAACF,EAAG,QAAQ,CAACG,MAAM,CAAC,OAAS,KAAK,CAACH,EAAG,QAAQ,CAACI,YAAY,aAAaF,YAAY,CAAC,eAAe,QAAQC,MAAM,CAAC,KAAO,KAAK,CAACH,EAAG,MAAM,CAACI,YAAY,cAAc,CAACJ,EAAG,OAAO,CAACJ,EAAIS,GAAG,SAASL,EAAG,UAAU,CAACE,YAAY,CAAC,MAAQ,SAASC,MAAM,CAAC,YAAc,WAAW,KAAO,QAAQ,WAAa,IAAIG,MAAM,CAACC,MAAOX,EAAIY,WAAa,GAAEC,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIY,WAAY,KAAME,IAAME,WAAW,oBAAoB,GAAGZ,EAAG,OAAO,CAACE,YAAY,CAAC,cAAc,SAAS,CAACN,EAAIS,GAAG,SAASL,EAAG,WAAW,CAACE,YAAY,CAAC,MAAQ,SAASC,MAAM,CAAC,KAAO,QAAQ,WAAa,IAAIU,GAAG,CAAC,OAASjB,EAAIkB,aAAaR,MAAM,CAACC,MAAOX,EAAIY,WAAiB,OAAEC,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIY,WAAY,SAAUE,IAAME,WAAW,sBAAsBhB,EAAImB,GAAInB,EAAIoB,OAAqB,gBAAE,SAASC,EAAKC,GAAO,OAAOlB,EAAG,kBAAkB,CAACmB,IAAID,EAAMf,MAAM,CAAC,MAAQc,EAAKV,QAAQ,CAACX,EAAIS,GAAG,IAAIT,EAAIwB,GAAGH,EAAKI,MAAM,UAAS,IAAI,OAAOrB,EAAG,QAAQ,CAACI,YAAY,aAAaD,MAAM,CAAC,KAAO,GAAG,MAAQ,UAAU,CAACH,EAAG,MAAM,CAACI,YAAY,cAAc,CAACJ,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,SAAS,CAACH,EAAG,WAAW,CAACG,MAAM,CAAC,mBAAmB,IAAI,sBAAsB,KAAKU,GAAG,CAAC,OAASjB,EAAI0B,qBAAqBhB,MAAM,CAACC,MAAOX,EAAIoB,OAAkB,YAAEP,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIoB,OAAQ,cAAeN,IAAME,WAAW,yBAAyB,GAAGZ,EAAG,WAAW,CAACI,YAAY,cAAcD,MAAM,CAAC,KAAO,UAAU,KAAO,SAASU,GAAG,CAAC,MAAQjB,EAAI2B,UAAU,CAAC3B,EAAIS,GAAG,QAAQL,EAAG,WAAW,CAACI,YAAY,cAAcD,MAAM,CAAC,KAAO,UAAU,KAAO,SAASU,GAAG,CAAC,MAAQjB,EAAI4B,WAAW,CAAC5B,EAAIS,GAAG,SAAS,MAAM,IAAI,GAAGL,EAAG,MAAM,CAACA,EAAG,UAAU,CAACG,MAAM,CAAC,QAAUP,EAAI6B,eAAe,cAAc7B,EAAI8B,SAAS,OAAS,SAAUT,GAAQ,OAAOA,EAAKvB,IAAM,QAAUE,EAAI+B,UAAU,YAAa,EAAM,OAAS,CAAEC,EAAG,OAAQC,YAAYjC,EAAIkC,GAAG,CAAC,CAACX,IAAI,UAAUY,GAAG,SAASC,EAASC,GAAK,OAAOjC,EAAG,OAAO,GAAG,CAACJ,EAAIS,GAAG,IAAIT,EAAIwB,GAAGa,EAAIC,IAAIC,MAAM,SAAS,CAAChB,IAAI,UAAUY,GAAG,SAASC,EAASC,GAAK,OAAOjC,EAAG,OAAO,GAAG,CAACJ,EAAIS,GAAG,IAAIT,EAAIwB,GAAGa,EAAIC,IAAIE,UAAU,SAAS,CAACjB,IAAI,QAAQY,GAAG,SAASC,EAASC,GAAK,OAAOjC,EAAG,OAAO,GAAG,CAACA,EAAG,IAAI,CAACG,MAAM,CAAC,KAAO8B,EAAII,UAAU,OAAS,WAAW,CAACzC,EAAIS,GAAGT,EAAIwB,GAAGY,UAAgB,CAACb,IAAI,aAAaY,GAAG,SAASC,EAASC,GAAK,OAAOjC,EAAG,OAAO,GAAG,CAACA,EAAG,OAAO,CAACsC,MAAM,CAAGC,MAAO,CAAC,EAAG,GAAI,GAAGC,SAASP,EAAIQ,QAAU,MAAQ,UAAY,CAAC7C,EAAIS,GAAGT,EAAIwB,GAAGY,UAAgB,CAACb,IAAI,SAASY,GAAG,SAASE,GAAK,OAAOjC,EAAG,OAAO,GAAG,CAACA,EAAG,IAAI,CAACa,GAAG,CAAC,MAAQ,SAAS6B,GAAQ,OAAO9C,EAAI+C,MAAMV,MAAQ,CAACrC,EAAIS,GAAG,QAAQL,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,cAAcH,EAAG,cAAc,CAACG,MAAM,CAAC,GAAK,CAAEyC,KAAM,kBAAmBC,MAAO,CAAEC,OAAQb,EAAIvC,KAAO,SAAW,KAAK,CAACE,EAAIS,GAAG,SAAS,UAAU,GAAGL,EAAG,MAAM,CAACE,YAAY,CAAC,aAAa,OAAO,QAAU,MAAM,mBAAmB,0EAA0E,CAACF,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,OAAS,KAAK,CAACH,EAAG,QAAQ,CAACI,YAAY,aAAaD,MAAM,CAAC,KAAO,KAAK,CAACH,EAAG,MAAM,CAACI,YAAY,cAAc,CAACJ,EAAG,OAAO,CAACE,YAAY,CAAC,YAAY,SAAS,CAACN,EAAIS,GAAG,aAAaL,EAAG,WAAW,CAACG,MAAM,CAAC,mBAAmB,IAAI,sBAAsB,KAAKU,GAAG,CAAC,OAASjB,EAAI0B,qBAAqBhB,MAAM,CAACC,MAAOX,EAAIoB,OAAkB,YAAEP,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIoB,OAAQ,cAAeN,IAAME,WAAW,yBAAyB,KAAKZ,EAAG,QAAQ,CAACI,YAAY,aAAaD,MAAM,CAAC,KAAO,GAAG,MAAQ,UAAU,CAACH,EAAG,MAAM,CAACI,YAAY,cAAc,CAACJ,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,QAAQ,gBAAkB,CAAC,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,MAAO,QAAQ,MAAQP,EAAImD,KAAKC,MAAM,aAAa,SAAUA,EAAOC,GAAS,MAAQ,KAAQA,EAAM,GAAM,MAASA,EAAM,GAAM,QAAWrD,EAAImD,KAAU,MAAI,MAAS,oBAAoB,GAAG,oBAAoB,IAAIlC,GAAG,CAAC,OAASjB,EAAIsD,gBAAgB,eAAiBtD,EAAIuD,qBAAqB,MAAM,IAAI,IAAI,GAAGnD,EAAG,UAAU,CAACG,MAAM,CAAC,MAAQ,OAAO,MAAiC,GAAzBP,EAAIoB,OAAOoC,aAAmBvC,GAAG,CAAC,GAAKjB,EAAIyD,qBAAqB,OAASzD,EAAI0D,0BAA0BhD,MAAM,CAACC,MAAOX,EAAI2D,QAAiB,UAAE9C,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAI2D,QAAS,YAAa7C,IAAME,WAAW,sBAAsB,CAACZ,EAAG,cAAc,CAACG,MAAM,CAAC,aAAY,EAAK,oCAAmC,GAAMG,MAAM,CAACC,MAAOX,EAAI2D,QAAY,KAAE9C,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAI2D,QAAS,OAAQ7C,IAAME,WAAW,mBAAmB,IAAI,IAC96I4C,EAAkB,G,4DC4GtB,GACEC,WAAY,CACVC,YAAJ,cAEEvB,KAAM,WACNwB,MAAO,CACLC,MAAO,CACLC,QAAS,MAEXC,YAAa,CACXD,SAAS,IAGbE,KAbF,WAcI,MAAO,CAELvD,WAAY,CACVd,GAAI,KACJkE,MAAO/D,KAAK+D,MACZnB,OAAQ,GACRuB,QAAS,EACTC,SAAU,IAIZxC,eAAgB,CACtB,CACQ,MAAR,KACQ,UAAR,KACQ,MAAR,IAEA,CACQ,MAAR,KACQ,MAAR,IACQ,YAAR,CAAU,aAAV,YAEA,CACQ,MAAR,KACQ,MAAR,IACQ,YAAR,CAAU,aAAV,YAEA,CACQ,MAAR,OACQ,UAAR,aACQ,MAAR,KAEA,CACQ,MAAR,OACQ,UAAR,YACQ,MAAR,KAEA,CACQ,MAAR,OACQ,UAAR,WACQ,MAAR,KAEA,CACQ,MAAR,WACQ,UAAR,QACQ,MAAR,IACQ,YAAR,CAAU,aAAV,UAEA,CACQ,MAAR,KACQ,UAAR,aACQ,MAAR,IACQ,MAAR,SACQ,MAAR,QACQ,YAAR,CAAU,aAAV,eAEA,CACQ,MAAR,KACQ,MAAR,IACQ,MAAR,SACQ,MAAR,QACQ,YAAR,CAAU,aAAV,YAGMC,SAAU,GACVwC,yBAA0B,GAC1BvC,WAAW,EAEX4B,QAAS,CACPY,WAAW,EACXJ,KAAM,GACNK,MAAO,MAITrB,KAAM,CACJC,MAAO,GAETqB,cAAe,KAGfrD,OAAQ,CACNsD,YAAa,GACbC,eAAgB,GAChBT,YAAajE,KAAKiE,YAClBV,YAAaoB,SAASC,gBAAgBrB,eAI5CsB,QAAS,CACPnD,QADJ,WAEM1B,KAAKiB,eAEP6D,OAJJ,aAOInD,SAPJ,WAQM3B,KAAK+E,QAAQC,IAAI,IAEnBC,0BAVJ,SAUA,GACMjF,KAAKqE,yBAA2Ba,GAGlC7B,gBAdJ,SAcA,KACMrD,KAAKW,WAAWwD,QAAUA,EAC1BnE,KAAKiB,eAEPqC,iBAlBJ,SAkBA,KACMtD,KAAKW,WAAWwD,QAAUA,EAC1BnE,KAAKW,WAAWyD,SAAWA,EAC3BpE,KAAKiB,eAEPA,YAvBJ,WAuBA,WACMjB,KAAK8B,WAAY,EACjBqD,EAAN,gFACQ,EAAR,aACQ,EAAR,qBACQ,EAAR,wBAGQ,IAAR,gBACYC,IAEE,CAAC,EAAG,EAAG,EAAG,GAAGzC,SAASyC,EAASxC,QAEjC,EAAZ,yBAGY,EAAZ,sBACY,EAAZ,8BAKIY,qBA7CJ,WA8CMxD,KAAK0D,QAAQY,WAAY,EACzBtE,KAAKqF,qBAEP5B,yBAjDJ,WAkDMzD,KAAKqF,qBAGP5D,oBArDJ,SAqDA,GACU6D,EACGtF,KAAKwE,gBACRxE,KAAKwE,cAAgBxE,KAAKuF,oBAG5BvF,KAAKwF,sBAGTD,iBA9DJ,WA8DA,WACM,OAAOE,aAAY,WACjB,EAAR,gBACA,MAEID,mBAnEJ,WAoEME,cAAc1F,KAAKwE,eACnBxE,KAAKwE,cAAgB,KACrBxE,KAAKmB,OAAO8C,aAAc,GAE5B0B,mBAxEJ,SAwEA,KACUL,EACGtF,KAAK0D,QAAQa,QAChBvE,KAAK0D,QAAQa,MAAQvE,KAAK4F,gBAAgBxD,IAG5CpC,KAAKqF,qBAGTO,gBAjFJ,SAiFA,cACM,OAAOH,aAAY,WACjB,EAAR,gBACA,MAEIJ,kBAtFJ,WAuFMK,cAAc1F,KAAK0D,QAAQa,OAC3BvE,KAAK0D,QAAQa,MAAQ,MAEvB3E,WA1FJ,SA0FA,cACMuF,EAAN,sCACQ,EAAR,wBAIIU,WAhGJ,WAgGA,WACM1E,EAAN,sCACQ,EAAR,6BAEMA,EAAN,yCACQ,EAAR,iCAGI2B,MAxGJ,SAwGA,GACM9C,KAAK0D,QAAQQ,KAAO,GACpBlE,KAAK0D,QAAQY,WAAY,EAGzBtE,KAAK2F,oBAAmB,EAAMvD,KAGlC0D,cAvNF,WAwNI9F,KAAKwF,qBACLxF,KAAKqF,qBAEPU,QA3NF,WA4NI/F,KAAK6F,aACL7F,KAAKiB,gBC1UoW,I,wBCQzW+E,EAAY,eACd,EACAlG,EACA6D,GACA,EACA,KACA,WACA,MAIa,aAAAqC,E,2CCnBf,yBAAwgB,EAAG","file":"js/chunk-34a1c54e.d9bf9475.js","sourcesContent":["import request from \"@/utils/request\";\r\n\r\n/************** Helper 相关 ********************/\r\nexport function getInstStatusList() {\r\n  return request({\r\n    url: \"/mng/enum/jobInstanceStatus\",\r\n    method: \"get\"\r\n  });\r\n}\r\n\r\nexport function getJobTypeList() {\r\n  return request({\r\n    url: \"/mng/enum/jobType\",\r\n    method: \"get\"\r\n  });\r\n}\r\n\r\nexport function getJobClientVersionList() {\r\n  return request({\r\n    url: \"/mng/enum/jobClientVersion\",\r\n    method: \"get\"\r\n  });\r\n}\r\n\r\nexport function getDefaultFlinkConfs() {\r\n  return request({\r\n    url: \"/mng/util/defaultFlinkConfs\",\r\n    method: \"get\"\r\n  });\r\n}\r\n","import request from \"@/utils/request\";\r\n\r\n/************** 实例相关 ********************/\r\nexport function getInstPageList(filter) {\r\n  return request({\r\n    url: \"/mng/jobInstance/queryJobInstances\",\r\n    method: \"get\",\r\n    params: filter\r\n  });\r\n}\r\n\r\nexport function getInstLog(id) {\r\n  return request({\r\n    url: \"/mng/jobInstance/startLog/\" + id,\r\n    method: \"get\"\r\n  });\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticStyle:{\"margin-bottom\":\"10px\",\"padding\":\"5px\",\"background-image\":\"linear-gradient(100deg, rgba(60, 213, 255, 0.5), rgba(60, 213, 255, 0.3))\"}},[_c('a-row',{attrs:{\"gutter\":16}},[_c('a-col',{staticClass:\"gutter-row\",staticStyle:{\"padding-left\":\"20px\"},attrs:{\"span\":14}},[_c('div',{staticClass:\"gutter-box\"},[_c('span',[_vm._v(\"ID : \"),_c('a-input',{staticStyle:{\"width\":\"100px\"},attrs:{\"placeholder\":\"eg. 1001\",\"size\":\"small\",\"allowClear\":\"\"},model:{value:(_vm.dataFilter.id),callback:function ($$v) {_vm.$set(_vm.dataFilter, \"id\", $$v)},expression:\"dataFilter.id\"}})],1),_c('span',{staticStyle:{\"margin-left\":\"10px\"}},[_vm._v(\"状态 : \"),_c('a-select',{staticStyle:{\"width\":\"100px\"},attrs:{\"size\":\"small\",\"allowClear\":\"\"},on:{\"change\":_vm.getDataList},model:{value:(_vm.dataFilter.status),callback:function ($$v) {_vm.$set(_vm.dataFilter, \"status\", $$v)},expression:\"dataFilter.status\"}},_vm._l((_vm.helper.instStatusList),function(item,index){return _c('a-select-option',{key:index,attrs:{\"value\":item.value}},[_vm._v(\" \"+_vm._s(item.desc)+\" \")])}),1)],1)])]),_c('a-col',{staticClass:\"gutter-row\",attrs:{\"span\":10,\"align\":\"right\"}},[_c('div',{staticClass:\"gutter-box\"},[_c('a-tooltip',{attrs:{\"title\":\"周期刷新\"}},[_c('a-switch',{attrs:{\"checked-children\":\"开\",\"un-checked-children\":\"关\"},on:{\"change\":_vm.handleDataListFlush},model:{value:(_vm.helper.isAutoFlush),callback:function ($$v) {_vm.$set(_vm.helper, \"isAutoFlush\", $$v)},expression:\"helper.isAutoFlush\"}})],1),_c('a-button',{staticClass:\"filter-tool\",attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.onQuery}},[_vm._v(\"查询\")]),_c('a-button',{staticClass:\"filter-tool\",attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.onGoBack}},[_vm._v(\"返回\")])],1)])],1)],1),_c('div',[_c('a-table',{attrs:{\"columns\":_vm.dataColumnList,\"data-source\":_vm.dataList,\"rowKey\":function (item) { return item.id; },\"loading\":_vm.isLoading,\"pagination\":false,\"scroll\":{ x: 1920 }},scopedSlots:_vm._u([{key:\"jobName\",fn:function(current, row){return _c('span',{},[_vm._v(\" \"+_vm._s(row.job.name)+\" \")])}},{key:\"jobType\",fn:function(current, row){return _c('span',{},[_vm._v(\" \"+_vm._s(row.job.typeDesc)+\" \")])}},{key:\"appId\",fn:function(current, row){return _c('span',{},[_c('a',{attrs:{\"href\":row.uiAddress,\"target\":\"_blank\"}},[_vm._v(_vm._s(current))])])}},{key:\"statusDesc\",fn:function(current, row){return _c('span',{},[_c('span',{style:({ color: [3, 4, -1].includes(row.status) ? 'red' : 'green' })},[_vm._v(_vm._s(current))])])}},{key:\"action\",fn:function(row){return _c('span',{},[_c('a',{on:{\"click\":function($event){return _vm.onLog(row)}}},[_vm._v(\"日志\")]),_c('a-divider',{attrs:{\"type\":\"vertical\"}}),_c('router-link',{attrs:{\"to\":{ path: 'inst/instDetail', query: { instId: row.id } },\"disabled\":\"\"}},[_vm._v(\"详情\")])],1)}}])})],1),_c('div',{staticStyle:{\"margin-top\":\"10px\",\"padding\":\"5px\",\"background-image\":\"linear-gradient(100deg, rgba(60,213,255,0.30), rgba(60,213,255,0.20))\"}},[_c('row',[_c('a-row',{attrs:{\"gutter\":16}},[_c('a-col',{staticClass:\"gutter-row\",attrs:{\"span\":12}},[_c('div',{staticClass:\"gutter-box\"},[_c('span',{staticStyle:{\"font-size\":\"16px\"}},[_vm._v(\"周期刷新 : \")]),_c('a-switch',{attrs:{\"checked-children\":\"开\",\"un-checked-children\":\"关\"},on:{\"change\":_vm.handleDataListFlush},model:{value:(_vm.helper.isAutoFlush),callback:function ($$v) {_vm.$set(_vm.helper, \"isAutoFlush\", $$v)},expression:\"helper.isAutoFlush\"}})],1)]),_c('a-col',{staticClass:\"gutter-row\",attrs:{\"span\":12,\"align\":\"right\"}},[_c('div',{staticClass:\"gutter-box\"},[_c('a-pagination',{attrs:{\"size\":\"small\",\"pageSizeOptions\":['1', '2', '10', '20', '30', '40', '50', '100', '500', '1000'],\"total\":_vm.page.total,\"show-total\":function (total, range) { return (\"第 \" + (range[0]) + \" ~ \" + (range[1]) + \" 项，共 \" + (_vm.page.total) + \" 项\"); },\"show-size-changer\":\"\",\"show-quick-jumper\":\"\"},on:{\"change\":_vm.onPageNumChange,\"showSizeChange\":_vm.onPageSizeChange}})],1)])],1)],1)],1),_c('a-modal',{attrs:{\"title\":\"实例日志\",\"width\":_vm.helper.clientWidth * 0.8},on:{\"ok\":_vm.handleInstLogModalOk,\"cancel\":_vm.handleInstLogModalCancel},model:{value:(_vm.instLog.isVisible),callback:function ($$v) {_vm.$set(_vm.instLog, \"isVisible\", $$v)},expression:\"instLog.isVisible\"}},[_c('SqlCMEditor',{attrs:{\"read-only\":true,\"auto-scroll-to-bottom-on-changes\":true},model:{value:(_vm.instLog.data),callback:function ($$v) {_vm.$set(_vm.instLog, \"data\", $$v)},expression:\"instLog.data\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <!-- Data Filter -->\r\n    <div style=\"margin-bottom: 10px; padding: 5px; background-image: linear-gradient(100deg, rgba(60, 213, 255, 0.5), rgba(60, 213, 255, 0.3));\">\r\n      <a-row :gutter=\"16\">\r\n        <a-col class=\"gutter-row\" :span=\"14\" style=\"padding-left: 20px\">\r\n          <div class=\"gutter-box\">\r\n            <span\r\n              >ID :\r\n              <a-input v-model=\"dataFilter.id\" placeholder=\"eg. 1001\" style=\"width: 100px\" size=\"small\" allowClear />\r\n            </span>\r\n            <!--<span style=\"margin-left: 10px\"\r\n              >名称 :\r\n              <a-input v-model=\"dataFilter.name\" placeholder=\"eg. 测试作业\" style=\"width: 200px\" size=\"small\" allowClear />\r\n            </span>-->\r\n            <!--<span style=\"margin-left: 10px\"\r\n              >类型 :\r\n              <a-select v-model=\"dataFilter.type\" style=\"width: 100px\" size=\"small\" allowClear>\r\n                <a-select-option v-for=\"(item, index) in helper.jobTypeList\" :key=\"index\" :value=\"item.value\">\r\n                  {{ item.desc }}\r\n                </a-select-option>\r\n              </a-select>\r\n            </span>-->\r\n            <span style=\"margin-left: 10px\"\r\n              >状态 :\r\n              <a-select v-model=\"dataFilter.status\" style=\"width: 100px\" size=\"small\" allowClear @change=\"getDataList\">\r\n                <a-select-option v-for=\"(item, index) in helper.instStatusList\" :key=\"index\" :value=\"item.value\">\r\n                  {{ item.desc }}\r\n                </a-select-option>\r\n              </a-select>\r\n            </span>\r\n          </div>\r\n        </a-col>\r\n        <a-col class=\"gutter-row\" :span=\"10\" align=\"right\">\r\n          <div class=\"gutter-box\">\r\n            <a-tooltip title=\"周期刷新\">\r\n              <a-switch checked-children=\"开\" un-checked-children=\"关\" v-model=\"helper.isAutoFlush\" @change=\"handleDataListFlush\" />\r\n            </a-tooltip>\r\n            <a-button type=\"primary\" size=\"small\" class=\"filter-tool\" @click=\"onQuery\">查询</a-button>\r\n            <a-button type=\"primary\" size=\"small\" class=\"filter-tool\" @click=\"onGoBack\">返回</a-button>\r\n          </div>\r\n        </a-col>\r\n      </a-row>\r\n    </div>\r\n\r\n    <!-- Data Table List -->\r\n    <div>\r\n      <a-table :columns=\"dataColumnList\" :data-source=\"dataList\" :rowKey=\"item => item.id\" :loading=\"isLoading\" :pagination=\"false\" :scroll=\"{ x: 1920 }\">\r\n        <span slot=\"jobName\" slot-scope=\"current, row\">\r\n          {{ row.job.name }}\r\n        </span>\r\n        <span slot=\"jobType\" slot-scope=\"current, row\">\r\n          {{ row.job.typeDesc }}\r\n        </span>\r\n        <span slot=\"appId\" slot-scope=\"current, row\">\r\n          <a :href=\"row.uiAddress\" target=\"_blank\">{{ current }}</a>\r\n        </span>\r\n        <span slot=\"statusDesc\" slot-scope=\"current, row\">\r\n          <span :style=\"{ color: [3, 4, -1].includes(row.status) ? 'red' : 'green' }\">{{ current }}</span>\r\n        </span>\r\n        <span slot=\"action\" slot-scope=\"row\">\r\n          <a @click=\"onLog(row)\">日志</a>\r\n          <a-divider type=\"vertical\" />\r\n          <router-link :to=\"{ path: 'inst/instDetail', query: { instId: row.id } }\" disabled>详情</router-link>\r\n        </span>\r\n      </a-table>\r\n    </div>\r\n\r\n    <!-- Bottom Tool -->\r\n    <!-- Tools -->\r\n    <div style=\"margin-top: 10px; padding: 5px; background-image: linear-gradient(100deg, rgba(60,213,255,0.30), rgba(60,213,255,0.20));\">\r\n      <row>\r\n        <a-row :gutter=\"16\">\r\n          <a-col class=\"gutter-row\" :span=\"12\">\r\n            <div class=\"gutter-box\">\r\n              <span style=\"font-size: 16px\">周期刷新 : </span>\r\n              <a-switch checked-children=\"开\" un-checked-children=\"关\" v-model=\"helper.isAutoFlush\" @change=\"handleDataListFlush\" />\r\n            </div>\r\n          </a-col>\r\n          <a-col class=\"gutter-row\" :span=\"12\" align=\"right\">\r\n            <div class=\"gutter-box\">\r\n              <a-pagination\r\n                size=\"small\"\r\n                :pageSizeOptions=\"['1', '2', '10', '20', '30', '40', '50', '100', '500', '1000']\"\r\n                :total=\"page.total\"\r\n                :show-total=\"(total, range) => `第 ${range[0]} ~ ${range[1]} 项，共 ${page.total} 项`\"\r\n                show-size-changer\r\n                show-quick-jumper\r\n                @change=\"onPageNumChange\"\r\n                @showSizeChange=\"onPageSizeChange\"\r\n              />\r\n            </div>\r\n          </a-col>\r\n        </a-row>\r\n      </row>\r\n    </div>\r\n\r\n    <!-- 实例日志的对话框 -->\r\n    <a-modal v-model=\"instLog.isVisible\" title=\"实例日志\" @ok=\"handleInstLogModalOk\" @cancel=\"handleInstLogModalCancel\" :width=\"helper.clientWidth * 0.8\">\r\n      <!--      <a-textarea v-model=\"instLog.data\" autoSize=\"auto\" />-->\r\n      <SqlCMEditor v-model=\"instLog.data\" :read-only=\"true\" :auto-scroll-to-bottom-on-changes=\"true\" />\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n<script>\r\nimport * as instApi from \"@/api/inst\";\r\nimport * as helperApi from \"@/api/helper\";\r\nimport * as utils from \"@/utils/utils\";\r\nimport SqlCMEditor from \"@/components/SqlCMEditor\";\r\nexport default {\r\n  components: {\r\n    SqlCMEditor\r\n  },\r\n  name: \"InstList\",\r\n  props: {\r\n    jobId: {\r\n      default: null\r\n    },\r\n    isAutoFlush: {\r\n      default: false\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      // DataFilter\r\n      dataFilter: {\r\n        id: null,\r\n        jobId: this.jobId,\r\n        status: \"\",\r\n        pageNum: 1,\r\n        pageSize: 10\r\n      },\r\n\r\n      // Data Table List\r\n      dataColumnList: [\r\n        {\r\n          title: \"ID\",\r\n          dataIndex: \"id\",\r\n          width: 80\r\n        },\r\n        {\r\n          title: \"名称\",\r\n          width: 200,\r\n          scopedSlots: { customRender: \"jobName\" }\r\n        },\r\n        {\r\n          title: \"类型\",\r\n          width: 100,\r\n          scopedSlots: { customRender: \"jobType\" }\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          dataIndex: \"createTime\",\r\n          width: 170\r\n        },\r\n        {\r\n          title: \"开始时间\",\r\n          dataIndex: \"startTime\",\r\n          width: 170\r\n        },\r\n        {\r\n          title: \"结束时间\",\r\n          dataIndex: \"stopTime\",\r\n          width: 170\r\n        },\r\n        {\r\n          title: \"Flink UI\",\r\n          dataIndex: \"appId\",\r\n          width: 280,\r\n          scopedSlots: { customRender: \"appId\" }\r\n        },\r\n        {\r\n          title: \"状态\",\r\n          dataIndex: \"statusDesc\",\r\n          width: 100,\r\n          align: \"center\",\r\n          fixed: \"right\",\r\n          scopedSlots: { customRender: \"statusDesc\" }\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          width: 130,\r\n          align: \"center\",\r\n          fixed: \"right\",\r\n          scopedSlots: { customRender: \"action\" }\r\n        }\r\n      ],\r\n      dataList: [],\r\n      dataTableSelectedRowKeys: [],\r\n      isLoading: false,\r\n\r\n      instLog: {\r\n        isVisible: false,\r\n        data: \"\",\r\n        timer: null\r\n      },\r\n\r\n      // Bottom Tool\r\n      page: {\r\n        total: 0\r\n      },\r\n      dataListTimer: null,\r\n\r\n      // helper\r\n      helper: {\r\n        jobTypeList: [],\r\n        instStatusList: [],\r\n        isAutoFlush: this.isAutoFlush,\r\n        clientWidth: document.documentElement.clientWidth\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    onQuery() {\r\n      this.getDataList();\r\n    },\r\n    onEdit() {\r\n      //\r\n    },\r\n    onGoBack() {\r\n      this.$router.go(-1);\r\n    },\r\n    onDataTableSelectedChange(selectedRowKeys) {\r\n      this.dataTableSelectedRowKeys = selectedRowKeys;\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    onPageNumChange(pageNum, pageSize) {\r\n      this.dataFilter.pageNum = pageNum;\r\n      this.getDataList();\r\n    },\r\n    onPageSizeChange(pageNum, pageSize) {\r\n      this.dataFilter.pageNum = pageNum;\r\n      this.dataFilter.pageSize = pageSize;\r\n      this.getDataList();\r\n    },\r\n    getDataList() {\r\n      this.isLoading = true;\r\n      instApi.getInstPageList(utils.objectDeleteBlankVK(this.dataFilter)).then(resp => {\r\n        this.isLoading = false;\r\n        this.dataList = resp.data.list;\r\n        this.page.total = resp.data.total;\r\n\r\n        // 获取实例列表中最新的实例，不是最终状态就开启周期刷新，否则关闭\r\n        let lastInst = this.dataList[0];\r\n        if (lastInst) {\r\n          // 3:启动失败，4:运行失败，5:已停止，6:运行成功\r\n          if ([3, 4, 5, 6].includes(lastInst.status)) {\r\n            // 关闭刷新\r\n            this.handleDataListFlush(false);\r\n          } else {\r\n            // 开启刷新\r\n            this.helper.isAutoFlush = true;\r\n            this.handleDataListFlush(true);\r\n          }\r\n        }\r\n      });\r\n    },\r\n    handleInstLogModalOk() {\r\n      this.instLog.isVisible = false;\r\n      this.clearInstLogTimer();\r\n    },\r\n    handleInstLogModalCancel() {\r\n      this.clearInstLogTimer();\r\n    },\r\n    /* 定时器自动刷新 */\r\n    handleDataListFlush(checked) {\r\n      if (checked) {\r\n        if (!this.dataListTimer) {\r\n          this.dataListTimer = this.getDataListTimer();\r\n        }\r\n      } else {\r\n        this.clearDataListTimer();\r\n      }\r\n    },\r\n    getDataListTimer() {\r\n      return setInterval(() => {\r\n        this.getDataList();\r\n      }, 1000);\r\n    },\r\n    clearDataListTimer() {\r\n      clearInterval(this.dataListTimer);\r\n      this.dataListTimer = null;\r\n      this.helper.isAutoFlush = false;\r\n    },\r\n    handleInstLogFlush(checked, row) {\r\n      if (checked) {\r\n        if (!this.instLog.timer) {\r\n          this.instLog.timer = this.getInstLogTimer(row);\r\n        }\r\n      } else {\r\n        this.clearInstLogTimer();\r\n      }\r\n    },\r\n    getInstLogTimer(row) {\r\n      return setInterval(() => {\r\n        this.getInstLog(row);\r\n      }, 1000);\r\n    },\r\n    clearInstLogTimer() {\r\n      clearInterval(this.instLog.timer);\r\n      this.instLog.timer = null;\r\n    },\r\n    getInstLog(row) {\r\n      instApi.getInstLog(row.id).then(resp => {\r\n        this.instLog.data = resp.data;\r\n      });\r\n    },\r\n    /* Helper */\r\n    initHelper() {\r\n      helperApi.getJobTypeList().then(resp => {\r\n        this.helper.jobTypeList = resp.data;\r\n      });\r\n      helperApi.getInstStatusList().then(resp => {\r\n        this.helper.instStatusList = resp.data;\r\n      });\r\n    },\r\n    onLog(row) {\r\n      this.instLog.data = \"\";\r\n      this.instLog.isVisible = true;\r\n\r\n      // 周期刷新\r\n      this.handleInstLogFlush(true, row);\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    this.clearDataListTimer();\r\n    this.clearInstLogTimer();\r\n  },\r\n  created() {\r\n    this.initHelper();\r\n    this.getDataList();\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n.filter-tool {\r\n  margin-left: 5px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=b1d374c4&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=b1d374c4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b1d374c4\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=b1d374c4&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=b1d374c4&scoped=true&lang=css&\""],"sourceRoot":""}